<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type="text/xsl" href="assets/xml/rss.xsl" media="all"?><rss xmlns:atom="http://www.w3.org/2005/Atom" version="2.0" xmlns:dc="http://purl.org/dc/elements/1.1/"><channel><title>David Dworken's Blog</title><link>http://blog.daviddworken.com/</link><description>David Dworken's Blog</description><atom:link href="http://blog.daviddworken.com/rss.xml" type="application/rss+xml" rel="self"></atom:link><language>en</language><lastBuildDate>Thu, 18 Feb 2016 23:34:30 GMT</lastBuildDate><generator>http://getnikola.com/</generator><docs>http://blogs.law.harvard.edu/tech/rss</docs><item><title>Website Hosting with KBFS</title><link>http://blog.daviddworken.com/posts/website-hosting-with-kbfs/</link><dc:creator>David Dworken</dc:creator><description>&lt;p&gt;KBFS is great not only for storing and signing files, but also for hosting a signed mirror of a website. By default keybase.pub is configured to look for a index.html or a index.md. So to mirror your static website in KBFS, just copy it all over into a folder in your public directory. For example, my &lt;a href="https://dworken.keybase.pub/blog/"&gt;blog&lt;/a&gt; and my &lt;a href="https://dworken.keybase.pub/website/index.html"&gt;website&lt;/a&gt; are both mirrored in KBFS. &lt;/p&gt;</description><guid>http://blog.daviddworken.com/posts/website-hosting-with-kbfs/</guid><pubDate>Thu, 18 Feb 2016 22:56:33 GMT</pubDate></item><item><title>Slope Field Generator</title><link>http://blog.daviddworken.com/posts/slope-field-generator/</link><dc:creator>David Dworken</dc:creator><description>&lt;div&gt;&lt;p&gt;In my BC Calculus class we were talking about slope fields and Euler's method, so I wanted to program my own slope field generator.&lt;/p&gt;
&lt;p&gt;See github.com/ddworken/SlopeFields/&lt;/p&gt;
&lt;p&gt;&lt;img alt="figure_1" src="https://cloud.githubusercontent.com/assets/5304541/12697204/5f73cdd8-c74b-11e5-9cff-0c7e8f0818c0.png"&gt;
&lt;img alt="figure_2" src="https://cloud.githubusercontent.com/assets/5304541/12697203/5f633db0-c74b-11e5-95fd-1a486c8d801a.png"&gt;
&lt;img alt="figure_3" src="https://cloud.githubusercontent.com/assets/5304541/12697274/672e5154-c74d-11e5-98da-6cfe54eabce3.png"&gt;
&lt;img alt="figure_4" src="https://cloud.githubusercontent.com/assets/5304541/12697949/0c72fd6c-c75e-11e5-81fb-fe990d56c3bc.png"&gt;
&lt;img alt="figure_5" src="https://cloud.githubusercontent.com/assets/5304541/12706974/7736c270-c85b-11e5-830b-7acaf35b4331.png"&gt;
&lt;img alt="figure_9" src="https://cloud.githubusercontent.com/assets/5304541/12723228/8e36fe92-c8d6-11e5-9371-6f6b214c2338.png"&gt;
&lt;img alt="figure_8" src="https://cloud.githubusercontent.com/assets/5304541/12723226/8e347e9c-c8d6-11e5-8c20-6408c164914b.png"&gt;
&lt;img alt="figure_7" src="https://cloud.githubusercontent.com/assets/5304541/12723227/8e34b272-c8d6-11e5-87ff-c39c22260561.png"&gt;
&lt;img alt="figure_6" src="https://cloud.githubusercontent.com/assets/5304541/12723229/8e3b7e72-c8d6-11e5-846e-d5fce1e0b201.png"&gt;&lt;/p&gt;&lt;/div&gt;</description><guid>http://blog.daviddworken.com/posts/slope-field-generator/</guid><pubDate>Wed, 17 Feb 2016 16:17:52 GMT</pubDate></item><item><title>KBFS On Linux</title><link>http://blog.daviddworken.com/posts/kbfs-on-linux/</link><dc:creator>David Dworken</dc:creator><description>&lt;div&gt;&lt;p&gt;By default, the KBFS will only run on linux. This is a short guide on how to setup KBFS on Linux (tested on Ubuntu 15.10 with a BTRFS root). Note that this is unsupported and takes a little bit of work to get it to work. &lt;/p&gt;
&lt;p&gt;Start by making sure you have the most recent version of Keybase. Assuming you installed from the &lt;code&gt;.deb&lt;/code&gt;, run &lt;code&gt;sudo apt-get upate&lt;/code&gt; then &lt;code&gt;sudo apt-get install keybase&lt;/code&gt;. &lt;/p&gt;
&lt;p&gt;So now we need to set up the filesystem for KBFS. Start by killing keybase so it doesn't mess with anything as we go: &lt;code&gt;sudo killall keybase&lt;/code&gt;. So now you need to create the &lt;code&gt;/keybase&lt;/code&gt; folder so run &lt;code&gt;sudo mkdir /keybase&lt;/code&gt;. Then we need to change the owner of &lt;code&gt;/keybase&lt;/code&gt; to your user (from root) so that keybase can modify this. So run &lt;code&gt;sudo chown username:username /keybase&lt;/code&gt;. Once that is done you can test it by &lt;code&gt;cd&lt;/code&gt;ing into the directory. &lt;/p&gt;
&lt;p&gt;So now just start the keybase daemon by running &lt;code&gt;run_keybase&lt;/code&gt;. A box will pop up asking you to unlock your device key so KBFS can run. From here you can &lt;code&gt;cd&lt;/code&gt; into &lt;code&gt;/keybase/&lt;/code&gt; to play around. &lt;/p&gt;
&lt;p&gt;Note that &lt;code&gt;ls&lt;/code&gt; and &lt;code&gt;cd&lt;/code&gt; have some weird behavior in this folder. Since it is a FUSE it doesn't follow all the normal specifications. For example, if you &lt;code&gt;cd /keybase/public/&lt;/code&gt; and &lt;code&gt;ls&lt;/code&gt; you will not see a &lt;code&gt;dworken&lt;/code&gt; folder, but if you &lt;code&gt;cd dworken&lt;/code&gt; you will enter my public folder. So when playing around don't expect KBFS to follow your normal expectations on how &lt;code&gt;cd&lt;/code&gt; and &lt;code&gt;ls&lt;/code&gt; work.&lt;/p&gt;&lt;/div&gt;</description><guid>http://blog.daviddworken.com/posts/kbfs-on-linux/</guid><pubDate>Tue, 16 Feb 2016 16:16:54 GMT</pubDate></item><item><title>(Ab)using Googleâ€™s Unlimited Photo Storage for Fun and Profit</title><link>http://blog.daviddworken.com/posts/abusing-googles-unlimited-photo-storage-for-fun-and-profit/</link><dc:creator>David Dworken</dc:creator><description>&lt;div&gt;&lt;h2&gt;'Unlimited' Storage&lt;/h2&gt;
&lt;p&gt;Google has recently made unlimited free storage available on google photos. At first glance this seems truly amazing (and ripe for abuse). The one caveat to this claim is that all photos uploaded to Google Photos are compressed with lossy compression. This means that any photos uploaded to Google Photos are automatically compressed thereby loosing some detail. &lt;/p&gt;
&lt;p&gt;At first glance, it would appear that this would prevent people from abusing their service since it would make it impossible to upload arbitrary files to their servers since lossy compression would destroy any files uploaded. This also means that many types of steganography would fail if one were to try to store arbitrary data on Google Photos. &lt;/p&gt;
&lt;h2&gt;The Workaround&lt;/h2&gt;
&lt;p&gt;By uploading images of text to Google Photos, we are able to upload arbitrary data. This is because whatever type of lossy image compression Google is using will leave all text in photos intact (as would be expected by the users of Google Photos). &lt;/p&gt;
&lt;p&gt;So this means that in order to store arbitray data on Google Photos, all you have to do is:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Base64 encode a file. &lt;/li&gt;
&lt;li&gt;Create a series of images containing the above text (Google Photos only allows images under 16 megapixels)&lt;/li&gt;
&lt;li&gt;Upload the images&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;And conversely, when retrieving the data from Google Photos, all that has to be done is:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Run image recognition on each photo to get the text.&lt;/li&gt;
&lt;li&gt;Base64 decode the text&lt;/li&gt;
&lt;li&gt;Concatenate the base64 decoded text from each image into one big file&lt;/li&gt;
&lt;/ol&gt;
&lt;h2&gt;The Code&lt;/h2&gt;
&lt;p&gt;I have written a custom python program to implement the above. The code for it is &lt;a href="https://github.com/ddworken/GooglePhotosStorage"&gt;here&lt;/a&gt;. To use it import is as a library and call getImages('fileToBackup') and it will generate the photos for you to upload to Google Photos. To recover the file, download the images from Google Photos into your current dir and call getMessage('fileToBackup'). &lt;/p&gt;
&lt;h2&gt;So What?&lt;/h2&gt;
&lt;p&gt;There are two main uses of this. The first use would be to use this to scheme to upload images to Google Photos thereby preventing Google from running their lossy compression algorithm on your photos. &lt;/p&gt;
&lt;p&gt;The other use of this would be as a true back up service. Since one can upload arbitray files to Google Photos, one can use this as a long term backup solution. One could even write a FUSE filesystem so as to allow for Google Photos to be mounted onto a computer as an external hard drive.&lt;/p&gt;&lt;/div&gt;</description><guid>http://blog.daviddworken.com/posts/abusing-googles-unlimited-photo-storage-for-fun-and-profit/</guid><pubDate>Thu, 06 Aug 2015 16:14:20 GMT</pubDate></item><item><title>Bug Bounties List!</title><link>http://blog.daviddworken.com/posts/bug-bounties-list/</link><dc:creator>David Dworken</dc:creator><description>&lt;div&gt;&lt;h2&gt;The List&lt;/h2&gt;
&lt;p&gt;Over the past 2 months, I've spent some time working on bug bounties. In the past two months, I have found vulnerabilities in the following websites: &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;AT&amp;amp;T&lt;/li&gt;
&lt;li&gt;Adobe&lt;/li&gt;
&lt;li&gt;Dyn&lt;/li&gt;
&lt;li&gt;Go Daddy&lt;/li&gt;
&lt;li&gt;Western Union&lt;/li&gt;
&lt;li&gt;Symantec&lt;/li&gt;
&lt;li&gt;IBM&lt;/li&gt;
&lt;li&gt;Vistaprint&lt;/li&gt;
&lt;li&gt;Hobby King&lt;/li&gt;
&lt;li&gt;Tumblr&lt;/li&gt;
&lt;li&gt;Haiku Learning&lt;/li&gt;
&lt;li&gt;Mozilla&lt;/li&gt;
&lt;li&gt;Maret&lt;/li&gt;
&lt;li&gt;eBay&lt;/li&gt;
&lt;li&gt;iFixIt&lt;/li&gt;
&lt;li&gt;MailChimp&lt;/li&gt;
&lt;li&gt;Amazon&lt;/li&gt;
&lt;li&gt;Steam&lt;/li&gt;
&lt;li&gt;Netflix&lt;/li&gt;
&lt;li&gt;Appcelerator&lt;/li&gt;
&lt;li&gt;mail.ru&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;So far most of these companies have responded and they have either patched or they are actively working towards patching the vulnerabilities. Once these companies approve public disclosure, I will be adding write ups for each vulnerability to the bottom of this blog post.&lt;/p&gt;&lt;/div&gt;</description><guid>http://blog.daviddworken.com/posts/bug-bounties-list/</guid><pubDate>Sun, 29 Mar 2015 16:13:18 GMT</pubDate></item><item><title>Using XSScrapy to Scan for XSS Vulnerabilities</title><link>http://blog.daviddworken.com/posts/using-xsscrapy-to-scan-for-xss-vulnerabilities/</link><dc:creator>David Dworken</dc:creator><description>&lt;div class="page"&gt;
    &lt;div class="preview-page"&gt;
    &lt;div class="container"&gt;
      &lt;div class="repository-with-sidebar repo-container with-full-navigation"&gt;
          &lt;div class="repository-content context-loader-container"&gt;
            &lt;div id="readme" class="boxed-group flush clearfix announce instapaper_body md"&gt;
              &lt;div class="markdown-body entry-content"&gt;
&lt;h1&gt;&lt;/h1&gt;
&lt;p&gt;&lt;a href="http://blog.daviddworken.com/posts/using-xsscrapy-to-scan-for-xss-vulnerabilities/#using-xsscrapy-to-scan-for-xss-vulnerabilities"&gt;&lt;span class="octicon octicon-link"&gt;&lt;/span&gt;&lt;/a&gt;Using XSScrapy to Scan for XSS Vulnerabilities&lt;/p&gt;
&lt;p&gt;&lt;a href="https://github.com/DanMcInerney/xsscrapy"&gt;XSScrapy&lt;/a&gt; is an amazing tool for the aspiring cyber security researcher. Entering the cyber security field used to be challenging and full of hours of wasted research with nothing to show for it. With XSScrapy, that is no longer true. 
&lt;/p&gt;&lt;h4&gt;&lt;/h4&gt;
&lt;p&gt;&lt;a href="http://blog.daviddworken.com/posts/using-xsscrapy-to-scan-for-xss-vulnerabilities/#so-what-is-an-xss-vulnerability"&gt;&lt;span class="octicon octicon-link"&gt;&lt;/span&gt;&lt;/a&gt;So what is an XSS Vulnerability&lt;/p&gt;
&lt;p&gt;A XSS vulnerability is what happens when a website displays user input without escaping this. If this makes sense to you, continue to the next section.&lt;/p&gt;
&lt;p&gt;A common example of when this would happen is if the website returned the following HTML:&lt;/p&gt;
&lt;div class="highlight highlight-html"&gt;&lt;pre&gt;&amp;lt;&lt;span class="pl-ent"&gt;a&lt;/span&gt; &lt;span class="pl-e"&gt;href&lt;/span&gt;=&lt;span class="pl-s1"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;[Link to the current page]&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;&amp;gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;So on &lt;code&gt;example.com&lt;/code&gt;, this would display:&lt;/p&gt;
&lt;div class="highlight highlight-html"&gt;&lt;pre&gt;&amp;lt;&lt;span class="pl-ent"&gt;a&lt;/span&gt; &lt;span class="pl-e"&gt;href&lt;/span&gt;=&lt;span class="pl-s1"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;http://example.com/&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;&amp;gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;By loading &lt;code&gt;example.com/"&amp;gt;&amp;lt;script&amp;gt;alert(0)&amp;lt;/script&amp;gt;&amp;lt;"&lt;/code&gt;, the  HTML becomes:&lt;/p&gt;
&lt;div class="highlight highlight-html"&gt;&lt;pre&gt;&amp;lt;&lt;span class="pl-ent"&gt;a&lt;/span&gt; &lt;span class="pl-e"&gt;href&lt;/span&gt;=&lt;span class="pl-s1"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;example.com/&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;&amp;gt;&lt;span class="pl-s2"&gt;&amp;lt;&lt;span class="pl-ent"&gt;script&lt;/span&gt;&amp;gt;&lt;span class="pl-s3"&gt;alert&lt;/span&gt;(&lt;span class="pl-c1"&gt;0&lt;/span&gt;)&amp;lt;/&lt;span class="pl-ent"&gt;script&lt;/span&gt;&amp;gt;&lt;/span&gt;&amp;lt;""&amp;gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Which when indented properly looks like:&lt;/p&gt;
&lt;div class="highlight highlight-html"&gt;&lt;pre&gt;&amp;lt;&lt;span class="pl-ent"&gt;a&lt;/span&gt; &lt;span class="pl-e"&gt;href&lt;/span&gt;=&lt;span class="pl-s1"&gt;&lt;span class="pl-pds"&gt;"&lt;/span&gt;example.com/&lt;span class="pl-pds"&gt;"&lt;/span&gt;&lt;/span&gt;&amp;gt;
&lt;span class="pl-s2"&gt;&amp;lt;&lt;span class="pl-ent"&gt;script&lt;/span&gt;&amp;gt;&lt;/span&gt;
&lt;span class="pl-s2"&gt;    &lt;span class="pl-s3"&gt;alert&lt;/span&gt;(&lt;span class="pl-c1"&gt;0&lt;/span&gt;)&lt;/span&gt;
&lt;span class="pl-s2"&gt;&amp;lt;/&lt;span class="pl-ent"&gt;script&lt;/span&gt;&amp;gt;&lt;/span&gt;
&amp;lt;""&amp;gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;All of which is valid HTML and will run properly. In this case, we have injected javascript code to display a popup box. While a popup box is not dangerous, the javascript can be used to do a number of other malicious things. For example, the injected javascript could automatically exfiltrate cookies back to an attacker owned server (thus giving the attacker access to the victim's account).&lt;/p&gt;
&lt;h3&gt;&lt;/h3&gt;
&lt;p&gt;&lt;a href="http://blog.daviddworken.com/posts/using-xsscrapy-to-scan-for-xss-vulnerabilities/#so-what-is-xsscrapy"&gt;&lt;span class="octicon octicon-link"&gt;&lt;/span&gt;&lt;/a&gt;So what is XSScrapy?&lt;/p&gt;
&lt;p&gt;XSScrapy is an XSS scanner written by Dan McInerney in Python. XSScrapy works by using scrapy to create a web spider to download the HTML of all pages on a given domain name. Scrapy finds URLs by automatically following all of the links on the website until it has scanned every single URL. Once the HTML for a page is downloaded, XSScrapy automatically searches the page for XSS vulnerabilities.&lt;/p&gt;
&lt;p&gt;This is done by looking for a number of common injection points and injecting the string &lt;code&gt;9zqjxel'"(){}&amp;lt;x&amp;gt;:9zqjxel;9&lt;/code&gt;. The important part of this string is &lt;code&gt;'"(){}&amp;lt;x&amp;gt;:;&lt;/code&gt;. This string contains pretty much every possibly "dangerous" character. So if the HTML is rendered without those characters being escaped, it is likely that there is an XSS vulnerability.&lt;/p&gt;
&lt;h3&gt;&lt;/h3&gt;
&lt;p&gt;&lt;a href="http://blog.daviddworken.com/posts/using-xsscrapy-to-scan-for-xss-vulnerabilities/#ok-lets-start-scanning"&gt;&lt;span class="octicon octicon-link"&gt;&lt;/span&gt;&lt;/a&gt;Ok, let's start scanning!&lt;/p&gt;
&lt;p&gt;First, follow the installation instructions &lt;a href="https://github.com/DanMcInerney/xsscrapy/blob/master/README.md"&gt;here&lt;/a&gt;. Once you have done that, let's find a website to scan.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Never&lt;/strong&gt; run XSScrapy against a domain that you do not own or have permission to penetration test. So if you are looking for a website to practice your new found skills on, try any website that offers a bug bounty. Look on websites like Bug Crowd, Hacker One, or CrowdCurity to find websites that allow for automated scanning.&lt;/p&gt;
&lt;p&gt;Once you found one, run:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;xsscrapy.py -u http://example.com&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Once the scan is finished, let's look through the &lt;code&gt;xsscrapy-vulns.txt&lt;/code&gt; file. So run &lt;code&gt;cat xsscrapy-vulns.txt&lt;/code&gt;. (Assuming the program found some potential vulnerabilities) This should give you a nice list of vulnerabilities in the form of:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;URL: [URL of the Vulnerability]
response URL: [URL of the Vulnerability]
Unfiltered: [The code causing the problem]
Payload: [What was injected to trigger the problem]
Type: [Type of Vulnerability]
Injection point: [Where the payload was injected]
Possible payloads: [A suggested payload to exploit: Note this is often incorrect]
Line: [The problematic line of HTML code]
`&amp;lt;/pre&amp;gt;

So now lets go through an example vulnerability report line by line. 

&amp;lt;pre&amp;gt;`URL: www.example.com/?q=9zqjxxe'"(){}&amp;lt;x&amp;gt;:9zqjxxe;9
response URL: www.example.com/?q=9zqjxxe'"(){}&amp;lt;x&amp;gt;:9zqjxxe;9
Unfiltered: '"(){}&amp;lt;x&amp;gt;
Payload: 9zqjxxe'"(){}&amp;lt;x&amp;gt;:9zqjxxe;9
Type: form
Injection point: q
Possible payloads: x"/onmouseover=prompt(9)/", x"x&amp;gt;&amp;lt;svG/onLoad=prompt(9)&amp;gt;, x" onmouseover=prompt(9) "
Line:  &amp;lt;input type="hidden" name="q" value="9zqjxgm'"(){}&amp;lt;x&amp;gt;:9zqjxgm;9
`&amp;lt;/pre&amp;gt;

### 
[&amp;lt;span class="octicon octicon-link"&amp;gt;&amp;lt;/span&amp;gt;](#developing-the-exploit-if-type--form)Developing the Exploit (if Type == form)

Take the URL from the first line and load it in your browser `www.example.com/?q=9zqjxxe'"(){}&amp;lt;x&amp;gt;:9zqjxxe;9`

Now modify the URL to `www.example.com/?q=`

Then look at the the last line of XSScrapy's vulnerability report: 

&amp;lt;pre&amp;gt;`Line:  &amp;lt;input type="hidden" name="q" value="9zqjxgm'"(){}&amp;lt;x&amp;gt;:9zqjxgm;9
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;So based off of the above except from the HTML, we can tell that we want to first add a &lt;code&gt;"&lt;/code&gt; to escape from the value variable followed by a &lt;code&gt;&amp;gt;&lt;/code&gt; to escape out into the HTML. Together, these two characters will get all following text to be interpreted as HTML. So now that we have that done, we simply tack a standard &lt;code&gt;&amp;lt;script&amp;gt;alert(0)&amp;lt;/script&amp;gt;&lt;/code&gt; onto the end of &lt;code&gt;"&amp;gt;&lt;/code&gt; making our final input &lt;code&gt;"&amp;gt;&amp;lt;script&amp;gt;alert(0)&amp;lt;/script&amp;gt;&lt;/code&gt;. So now we have our payload.&lt;/p&gt;
&lt;p&gt;Take that payload and add it on to the URL we got earlier (&lt;code&gt;www.example.com/?q=&lt;/code&gt;) to make &lt;code&gt;www.example.com/?q="&amp;gt;&amp;lt;script&amp;gt;alert(0)&amp;lt;/script&amp;gt;&lt;/code&gt;. Then load that URL, and you should get a pop up box displaying &lt;code&gt;0&lt;/code&gt;!&lt;/p&gt;
&lt;p&gt;Now that you have gotten this far, the final step is to report the vulnerability to the website. Create an account on what ever bug bounty website they use and submit it. If you've gotten this far, then Congratulations! You've reported your first vulnerability.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;          &amp;lt;/div&amp;gt;
        &amp;lt;/div&amp;gt;
      &amp;lt;/div&amp;gt;
  &amp;lt;/div&amp;gt;
&amp;lt;/div&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
  &lt;/div&gt;
  &lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;</description><guid>http://blog.daviddworken.com/posts/using-xsscrapy-to-scan-for-xss-vulnerabilities/</guid><pubDate>Thu, 26 Feb 2015 16:10:26 GMT</pubDate></item><item><title>pyWMATA</title><link>http://blog.daviddworken.com/posts/pywmata/</link><dc:creator>David Dworken</dc:creator><description>&lt;div&gt;&lt;p&gt;For a while now I've been wanting to make my own interface to WMATA's API. WMATA (Washington Metropolitan Area Transit Authority) has a pretty good API that allows for you to get anything from current train locations, a path between two stations on the same line, elevator/escalator/rail incidents, even an API endpoint for stations near a location. &lt;/p&gt;
&lt;p&gt;The one thing that is lacking is an API to go from any one station to another. Their API does have an endpoint to get a list of stations between any two given stations with the caveat that this only works if the supplied stations are on the same line. &lt;/p&gt;
&lt;p&gt;So I wrote my own wrapper around their API in python that implements this and much much more. &lt;/p&gt;
&lt;p&gt;https://github.com/ddworken/pyWMATA&lt;/p&gt;&lt;/div&gt;</description><guid>http://blog.daviddworken.com/posts/pywmata/</guid><pubDate>Sat, 07 Feb 2015 16:08:10 GMT</pubDate></item><item><title>Scanning for Malicious Proxies</title><link>http://blog.daviddworken.com/posts/scanning-for-malicious-proxies/</link><dc:creator>David Dworken</dc:creator><description>&lt;div&gt;&lt;p&gt;In the past few years, there has been a lot of press about HTTP proxies that transparently modify traffic to inject javascript for malicious purposes. There have been multiple presentations at DEFCON and blackhat about this topic and a variety of ways of exploiting it including: DDOS, credential theft, and even a distributed method of storage.Â &lt;/p&gt;
&lt;p&gt;Due to this, I decided to write a script to automatically scan proxies for malicious behavior such as: injecting javascript, modifying forms, and editing HTML.Â &lt;/p&gt;
&lt;p&gt;The first step was to get a list of proxies that are currently up and freely accessible. For this, I used a modified version of Dan McInerney's Elite Proxy Finder. Originally, this script allowed for automated speed testing and discovery of elite proxies. I modified this script so as to:Â &lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;OutputÂ &lt;strong&gt;all&lt;/strong&gt;Â types of proxies, not just elite proxies (since anonymity is not an issue).&lt;/li&gt;
&lt;li&gt;Output proxies that support only http. This was done because proxies are not able to modify resources transmitted over SSL, so support for a protocol that I will not be testing is not needed.&lt;/li&gt;
&lt;li&gt;Export a list of proxies and their ports&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;From there, I had a list of approximately 1000 active free proxies. While this is a relatively small number, I decided to move on with the experiment to see if there was any malicious behavior to be observed even in this small sample size. So on to the results!&lt;/p&gt;
&lt;p&gt;~In all 1500 proxies, there was no malicious traffic. What I mean by this is that no proxies transparently edited the traffic without making it very clear that one was not reaching the requested website. There was no injection of javascript. There was no modification of forms. Absolutely no interesting modifications.~&lt;/p&gt;
&lt;p&gt;~Thus the next step is going to be to use masscan to scan the ipv4 address space to look for free proxies, then once again search for malicious behavior.~&lt;/p&gt;
&lt;p&gt;The code used for this post is posted &lt;a href="https://github.com/ddworken/maliciousProxyScanner"&gt;here&lt;/a&gt;Â &lt;/p&gt;
&lt;p&gt;Update: I updated the script slightly so as to increase the number of proxies it discovered. With the addition of the updated script, I have discovered a number of malicious proxies that are currently active.Â &lt;/p&gt;
&lt;p&gt;Here is a list of all proxies detected with errant behavior and a description of their errant behavior.&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;The proxy server at&lt;/p&gt;
&lt;p&gt;&lt;code&gt;221.183.16.219:00080&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;modifies HTML sent over HTTP to add the following code to every webpage&lt;/p&gt;
&lt;pre class="code literal-block"&gt;&lt;span class="nt"&gt;&amp;lt;script&lt;/span&gt; &lt;span class="na"&gt;type=&lt;/span&gt;&lt;span class="s"&gt;'text/javascript'&lt;/span&gt; &lt;span class="na"&gt;charset=&lt;/span&gt;&lt;span class="s"&gt;'utf-8'&lt;/span&gt; &lt;span class="na"&gt;src=&lt;/span&gt;&lt;span class="s"&gt;'http://www.adfocus.com.cn/adscript/adfocus.js'&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&amp;lt;/script&amp;gt;&lt;/span&gt;
&lt;/pre&gt;


&lt;p&gt;Sadly, the adfocus.com.cn domain is not currently accessible, so I cannot view the injected javascript. Based off of the URL of the injected javascript, two conclusions can be made.Â &lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;It is javascript used to automatically inject ads into websites accessed over HTTP. This seems to be the most obvious solution since the domain is "adfocus.com.cn" and the javascript file is stored in the "adscript" folder and is called "adfocus.js". This would make sense since it is a free proxy, the owners of the proxy are likely trying to monetize the business.Â &lt;/li&gt;
&lt;li&gt;However, it seems like this might be what we are supposed to think. I say this because the javascript is hosted on the adfocus.com.cn domain, very similar to the legitimate adfocus.com. It might be that the administrators of this proxy are attempting to capture the reputation of adfocus.com so as to prove the legitimate nature of the injected code. This makes me wonder whether this code serves a more malicious purpose. The injected javascript could do anything from exploit the computer to be part of a botnet to be part of a distributed filesystem.&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;p&gt;The proxy server at&lt;/p&gt;
&lt;pre class="code literal-block"&gt;115.239.210.199:80
&lt;/pre&gt;


&lt;p&gt;automatically strips all HTML comments from the transmitted data. While this does not have any obvious negative effect, it still modifies the transmitted HTML which is an inherently bad thing for any proxy server to do.Â &lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;The proxy server at&lt;/p&gt;
&lt;pre class="code literal-block"&gt;60.194.40.198:8118
&lt;/pre&gt;


&lt;p&gt;modifies HTML sent over HTTP to add the following code to every webpage&lt;/p&gt;
&lt;pre class="code literal-block"&gt;&lt;span class="nt"&gt;&amp;lt;script&lt;/span&gt; &lt;span class="na"&gt;type=&lt;/span&gt;&lt;span class="s"&gt;"text/javascript"&lt;/span&gt; &lt;span class="na"&gt;charset=&lt;/span&gt;&lt;span class="s"&gt;"utf-8"&lt;/span&gt; &lt;span class="na"&gt;mediaproAccountID=&lt;/span&gt;&lt;span class="s"&gt;"0"&lt;/span&gt; &lt;span class="na"&gt;mediaproSlotID=&lt;/span&gt;&lt;span class="s"&gt;"0"&lt;/span&gt; &lt;span class="na"&gt;usermac=&lt;/span&gt;&lt;span class="s"&gt;""&lt;/span&gt; &lt;span class="na"&gt;src=&lt;/span&gt;&lt;span class="s"&gt;"/7b26d4601fbe440b35e496a0fcfa15f7/000c4347fbe8/w1/i.js"&lt;/span&gt; &lt;span class="na"&gt;async=&lt;/span&gt;&lt;span class="s"&gt;"async"&lt;/span&gt; &lt;span class="err"&gt;defer&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&amp;lt;/script&amp;gt;&amp;lt;meta&lt;/span&gt; &lt;span class="na"&gt;http-equiv=&lt;/span&gt;&lt;span class="s"&gt;"Content-Type"&lt;/span&gt; &lt;span class="na"&gt;content=&lt;/span&gt;&lt;span class="s"&gt;"text/html; charset=UTF-8"&lt;/span&gt; &lt;span class="nt"&gt;/&amp;gt;&lt;/span&gt;
&lt;/pre&gt;


&lt;hr&gt;
&lt;p&gt;The interesting this about this javascript, is that the source of the javascript is on / (aka the server itself). At first glance, this seems impossible, but it turns out what the proxy is doing is hijacking all requests to &lt;code&gt;7b26d4601fbe440b35e496a0fcfa15f7/000c4347fbe8/w1/i.js&lt;/code&gt; (hence the long randomly generated string) and replying with a javascript file that is actually not hosted on the webserver of the page you are trying to access. &lt;/p&gt;
&lt;p&gt;The proxy server at&lt;/p&gt;
&lt;pre class="code literal-block"&gt;122.225.106.35:80
&lt;/pre&gt;


&lt;p&gt;modifies HTML sent over HTTP to add the following code to every webpage&lt;/p&gt;
&lt;pre class="code literal-block"&gt;&lt;span class="nt"&gt;&amp;lt;link&lt;/span&gt; &lt;span class="na"&gt;rel=&lt;/span&gt;&lt;span class="s"&gt;"stylesheet"&lt;/span&gt; &lt;span class="na"&gt;type=&lt;/span&gt;&lt;span class="s"&gt;"text/css"&lt;/span&gt; &lt;span class="na"&gt;href=&lt;/span&gt;&lt;span class="s"&gt;"http://ads.adt100.com/bottom.css"&lt;/span&gt; &lt;span class="nt"&gt;/&amp;gt;&amp;lt;div&lt;/span&gt; &lt;span class="na"&gt;id=&lt;/span&gt;&lt;span class="s"&gt;"center_xad"&lt;/span&gt; &lt;span class="na"&gt;class=&lt;/span&gt;&lt;span class="s"&gt;"cwindow_xad"&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;    &lt;span class="nt"&gt;&amp;lt;div&lt;/span&gt; &lt;span class="na"&gt;class=&lt;/span&gt;&lt;span class="s"&gt;"center_title_xad"&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;          &lt;span class="nt"&gt;&amp;lt;img&lt;/span&gt; &lt;span class="na"&gt;onclick=&lt;/span&gt;&lt;span class="s"&gt;"closeWindow()"&lt;/span&gt; &lt;span class="na"&gt;width=&lt;/span&gt;&lt;span class="s"&gt;"15px"&lt;/span&gt; &lt;span class="na"&gt;height=&lt;/span&gt;&lt;span class="s"&gt;"15px"&lt;/span&gt; &lt;span class="na"&gt;src=&lt;/span&gt;&lt;span class="s"&gt;"http://ads.adt100.com/images/close_btn.gif"&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;    &lt;span class="nt"&gt;&amp;lt;/div&amp;gt;&lt;/span&gt;  &lt;span class="nt"&gt;&amp;lt;div&lt;/span&gt; &lt;span class="na"&gt;id=&lt;/span&gt;&lt;span class="s"&gt;'center_xad_cnt'&lt;/span&gt; &lt;span class="na"&gt;class=&lt;/span&gt;&lt;span class="s"&gt;"injection_content"&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&lt;/span&gt; &lt;span class="na"&gt;id=&lt;/span&gt;&lt;span class="s"&gt;"right_xad"&lt;/span&gt; &lt;span class="na"&gt;class=&lt;/span&gt;&lt;span class="s"&gt;"window_xad"&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;  &lt;span class="nt"&gt;&amp;lt;div&lt;/span&gt; &lt;span class="na"&gt;class=&lt;/span&gt;&lt;span class="s"&gt;"right_title_xad"&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&amp;lt;img&lt;/span&gt; &lt;span class="na"&gt;onclick=&lt;/span&gt;&lt;span class="s"&gt;"closeWindow()"&lt;/span&gt; &lt;span class="na"&gt;width=&lt;/span&gt;&lt;span class="s"&gt;"15px"&lt;/span&gt; &lt;span class="na"&gt;height=&lt;/span&gt;&lt;span class="s"&gt;"15px"&lt;/span&gt; &lt;span class="na"&gt;src=&lt;/span&gt;&lt;span class="s"&gt;"http://ads.adt100.com/images/close_btn.gif"&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&lt;/span&gt; &lt;span class="na"&gt;id=&lt;/span&gt;&lt;span class="s"&gt;'right_xad_cnt'&lt;/span&gt; &lt;span class="na"&gt;class=&lt;/span&gt;&lt;span class="s"&gt;"injection_content"&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;script&lt;/span&gt; &lt;span class="na"&gt;type=&lt;/span&gt;&lt;span class="s"&gt;"text/javascript"&lt;/span&gt; &lt;span class="na"&gt;src=&lt;/span&gt;&lt;span class="s"&gt;"http://ads.adt100.com/bottom.js"&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&amp;lt;/script&amp;gt;&amp;lt;/body&amp;gt;&lt;/span&gt;
&lt;/pre&gt;


&lt;p&gt;This code does a number of interesting things. First of all, it adds a &lt;a href="http://ads.adt100.com/bottom.css"&gt;new CSS style sheet&lt;/a&gt;. While the style sheet does not do anything malicious (instead choosing to allow the page to appear normally) it is clearly malicious in its purpose, the stylesheet is not the key to the malicious code.The interesting part is &lt;a href="http://ads.adt100.com/bottom.js"&gt;here&lt;/a&gt;. As my knowledge of javascript is quite limited, I'm going to stop my analysis here. But based off of a quick read through of the code, it seems to be malicious in nature considering the injection of a flash object attempting to download an &lt;a href="https://www.virustotal.com/en/file/3e9749762d7390ac3e6ba4ff7e93ce3fe2fcf6a05ad6cef736e1d4d782858dec/analysis/1421268628/"&gt;exe&lt;/a&gt;.&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;So far, I have only analyzed a few select malicious proxies. A full data dump from running this script is available in the Github repo &lt;a href="https://github.com/ddworken/maliciousProxyScanner/blob/master/output.txt"&gt;here &lt;/a&gt;if anyone wants to give an automated analysis a shot (6500+ lines).&lt;/p&gt;&lt;/div&gt;</description><guid>http://blog.daviddworken.com/posts/scanning-for-malicious-proxies/</guid><pubDate>Mon, 12 Jan 2015 16:00:39 GMT</pubDate></item><item><title>Recoverable Secret Generator</title><link>http://blog.daviddworken.com/posts/Recoverable Secret Generator/</link><dc:creator>David Dworken</dc:creator><description>&lt;div&gt;&lt;p&gt;David Dworken&lt;/p&gt;
&lt;p&gt;1/6/15&lt;/p&gt;
&lt;p&gt;Error Correcting Storage of Secrets in Human Memory&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Abstract&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Â  Â  In the past a number of different schemes have been proposed for the storage of encryption secrets in human memory. The vast majority of these schemes rely on the idea of asking the user to memorize a passphrase, often a string of randomly generated words, and then running this passphrase though a key derivation formula, often a hashing algorithm, to deterministically generate an encryption key. This method has a number of weaknesses. Whenever any sort of error is introduced, the key is drastically changed. This has the benefit of preventing calculation of the passphrase from the encryption key. The problem with this is it causes a minor error in human memory to lead to a completely different encryption key. If one were to: forget a part of the passphrase, input the string of words in the incorrect order, or misspell one of the words the generation scheme would fail. All of these errors are extremely likely to occur when humans attempt to memorize a series of words.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Passphrase&lt;/strong&gt; &lt;strong&gt;Generation&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Â  Â  A new RSG compatible passphrase can be generated by following this general list of steps:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;Randomly generate a number between 0 and 5120&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$randomNumber % Â 512&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;This is done to decrease the range of possible random numbers to 0 to 512. A random number in this range was not calculated originally since it allowed an attacker to figure out the state of pythonâ€™s RNG from only part of the password.&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Calculate what word from the PGP wordlist corresponds to that random number&lt;/p&gt;
&lt;p&gt;Add that word to the passphrase variable. &lt;/p&gt;
&lt;p&gt;Add a space to the passphrase variable&lt;/p&gt;
&lt;p&gt;Repeat steps 1 through 5 until a passphrase with enough entropy has been generated. &lt;/p&gt;
&lt;p&gt;Â  Â  The corresponding checksum for a given passphrase can be generated by following this general list of steps:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;Split the passphrase into a list of strings, each of which is a single word from the PGP wordlist&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Calculate the place of each word in the wordlist&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Add this number to the sum variable&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Repeat steps 1 through 3 until you have iterated through all words&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Encode Â $sum % 512 into a word from the PGP wordlist, this is the checksum&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;strong&gt;Authentication&lt;/strong&gt; &lt;strong&gt;and&lt;/strong&gt; &lt;strong&gt;Key&lt;/strong&gt; &lt;strong&gt;Generation&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Â  Â The Recoverable Secret Generator, or RSG for short, allows all of these errors to occur while still allowing the passphrases with high entropy. RSG allows for automatic correction of: forgotten words, incorrect ordering of the words, and misspelled words.&lt;/p&gt;
&lt;p&gt;Â  Â  Incorrect ordering of the words is solved by simply requiring the passphrase to be alphabetized. This means that whenever the passphrase is supplied, the key generation algorithm must first alphabetize the input. &lt;/p&gt;
&lt;p&gt;Â  Â  Misspelled words can be corrected through Levenshtein distance matching. The key generation algorithm first breaks the passphrase into a list of words. Each word is then checked against the list of words used in the generation of the passphrase. Any words that are not found in the list of possible words, are marked. Then the program computes the Levenshtein distance between the incorrect word and every word in the wordlist. The word that the incorrect word is closed to according to the Levenshtein distance is then stored in the place of the incorrect word. &lt;/p&gt;
&lt;p&gt;Â  Â  Correcting for forgotten words must be done as the final step in the key generation algorithm. A checksum of the passphrase is generated (as described in the Passphrase Generation section) and compared to the user supplied passphrase checksum word. If the calculated checksum is the same as the user supplied checksum,then no words have been forgotten. If the checksums do not match, the difference between the user supplied checksum and the calculated checksum is calculated. The difference is then encoded as a word, which is the forgotten word.&lt;/p&gt;
&lt;p&gt;See a python implementation of this for key generation and general authentication against a hash &lt;a href="https://github.com/ddworken/recoverableSecretGenerator"&gt;here&lt;/a&gt;. Implementations in other languages are welcome!Â &lt;/p&gt;&lt;/div&gt;</description><guid>http://blog.daviddworken.com/posts/Recoverable Secret Generator/</guid><pubDate>Tue, 06 Jan 2015 15:53:05 GMT</pubDate></item></channel></rss>